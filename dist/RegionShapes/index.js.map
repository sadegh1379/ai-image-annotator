{"version":3,"file":"index.js","names":["_slicedToArray","React","memo","colorAlpha","clamp","num","min","max","RegionComponents","point","_ref","region","iw","ih","createElement","transform","concat","x","y","d","strokeWidth","stroke","color","fill","line","_ref2","x1","y1","x2","y2","box","_ref3","width","Math","w","height","h","polygon","_ref4","fullSegmentationMode","Component","open","alphaBase","points","map","_ref5","_ref6","a","join","keypoints","_ref7","keypointDefinitions","keypointsDefinitionId","Error","_keypointDefinitions$","landmarks","connections","Object","entries","_ref8","i","_ref9","keypointId","_ref9$","key","_ref10","_ref11","kp1Id","kp2Id","kp1","kp2","midPoint","_ref12","_region$expandingWidt","expandingWidth","slice","pointPairs","_ref13","angle","n","length","p","atan2","PI","dx","sin","dy","cos","firstSection","_ref14","_ref15","p1","p2","secondSection","_ref16","_ref17","asMutable","reverse","lastPoint","Fragment","candidatePoint","_ref18","pixel","WrappedRegionList","_ref19","regions","filter","r","visible","type","regionId","RegionShapes","_ref20","mat","imagePosition","_ref20$regions","bottomRight","topLeft","isNaN","style","position","zIndex","left","top","pointerEvents"],"sources":["../../src/RegionShapes/index.js"],"sourcesContent":["import _slicedToArray from '@babel/runtime/helpers/esm/slicedToArray'\nimport React, { memo } from 'react'\nimport colorAlpha from 'color-alpha'\n\nfunction clamp(num, min, max) {\n\treturn num <= min ? min : num >= max ? max : num\n}\n\nvar RegionComponents = {\n\tpoint: memo(function (_ref) {\n\t\tvar region = _ref.region,\n\t\t\tiw = _ref.iw,\n\t\t\tih = _ref.ih\n\t\treturn React.createElement('g', {\n\t\t\ttransform: 'translate('.concat(region.x * iw, ' ').concat(region.y * ih, ')')\n\t\t}, React.createElement('path', {\n\t\t\td: 'M0 8L8 0L0 -8L-8 0Z',\n\t\t\tstrokeWidth: 2,\n\t\t\tstroke: region.color,\n\t\t\tfill: 'transparent'\n\t\t}))\n\t}),\n\tline: memo(function (_ref2) {\n\t\tvar region = _ref2.region,\n\t\t\tiw = _ref2.iw,\n\t\t\tih = _ref2.ih\n\t\treturn React.createElement('g', {\n\t\t\ttransform: 'translate('.concat(region.x1 * iw, ' ').concat(region.y1 * ih, ')')\n\t\t}, React.createElement('line', {\n\t\t\tstrokeWidth: 2,\n\t\t\tx1: 0,\n\t\t\ty1: 0,\n\t\t\tx2: (region.x2 - region.x1) * iw,\n\t\t\ty2: (region.y2 - region.y1) * ih,\n\t\t\tstroke: colorAlpha(region.color, 0.75),\n\t\t\tfill: colorAlpha(region.color, 0.1)\n\t\t}))\n\t}),\n\tbox: memo(function (_ref3) {\n\t\tvar region = _ref3.region,\n\t\t\tiw = _ref3.iw,\n\t\t\tih = _ref3.ih\n\t\treturn React.createElement('g', {\n\t\t\ttransform: 'translate('.concat(region.x * iw, ' ').concat(region.y * ih, ')')\n\t\t}, React.createElement('rect', {\n\t\t\tstrokeWidth: 2,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: Math.max(region.w * iw, 0),\n\t\t\theight: Math.max(region.h * ih, 0),\n\t\t\tstroke: colorAlpha(region.color, 0.75),\n\t\t\tfill: colorAlpha(region.color, 0.1)\n\t\t}))\n\t}),\n\tpolygon: memo(function (_ref4) {\n\t\tvar region = _ref4.region,\n\t\t\tiw = _ref4.iw,\n\t\t\tih = _ref4.ih,\n\t\t\tfullSegmentationMode = _ref4.fullSegmentationMode\n\t\tvar Component = region.open ? 'polyline' : 'polygon'\n\t\tvar alphaBase = fullSegmentationMode ? 0.5 : 1\n\t\treturn React.createElement(Component, {\n\t\t\tpoints: region.points.map(function (_ref5) {\n\t\t\t\tvar _ref6 = _slicedToArray(_ref5, 2),\n\t\t\t\t\tx = _ref6[0],\n\t\t\t\t\ty = _ref6[1]\n\n\t\t\t\treturn [x * iw, y * ih]\n\t\t\t}).map(function (a) {\n\t\t\t\treturn a.join(' ')\n\t\t\t}).join(' '),\n\t\t\tstrokeWidth: 2,\n\t\t\tstroke: colorAlpha(region.color, 0.75),\n\t\t\tfill: colorAlpha(region.color, 0.1)\n\t\t})\n\t}),\n\tkeypoints: function keypoints(_ref7) {\n\t\tvar region = _ref7.region,\n\t\t\tiw = _ref7.iw,\n\t\t\tih = _ref7.ih,\n\t\t\tkeypointDefinitions = _ref7.keypointDefinitions\n\t\tvar points = region.points,\n\t\t\tkeypointsDefinitionId = region.keypointsDefinitionId\n\n\t\tif (!keypointDefinitions[keypointsDefinitionId]) {\n\t\t\tthrow new Error('No definition for keypoint configuration \"'.concat(keypointsDefinitionId, '\"'))\n\t\t}\n\n\t\tvar _keypointDefinitions$ = keypointDefinitions[keypointsDefinitionId],\n\t\t\tlandmarks = _keypointDefinitions$.landmarks,\n\t\t\tconnections = _keypointDefinitions$.connections\n\t\treturn React.createElement('g', null, Object.entries(points).map(function (_ref8, i) {\n\t\t\tvar _ref9 = _slicedToArray(_ref8, 2),\n\t\t\t\tkeypointId = _ref9[0],\n\t\t\t\t_ref9$ = _ref9[1],\n\t\t\t\tx = _ref9$.x,\n\t\t\t\ty = _ref9$.y\n\n\t\t\treturn React.createElement('g', {\n\t\t\t\tkey: i,\n\t\t\t\ttransform: 'translate('.concat(x * iw, ' ').concat(y * ih, ')')\n\t\t\t}, React.createElement('path', {\n\t\t\t\td: 'M0 8L8 0L0 -8L-8 0Z',\n\t\t\t\tstrokeWidth: 2,\n\t\t\t\tstroke: landmarks[keypointId].color,\n\t\t\t\tfill: 'transparent'\n\t\t\t}))\n\t\t}), connections.map(function (_ref10) {\n\t\t\tvar _ref11 = _slicedToArray(_ref10, 2),\n\t\t\t\tkp1Id = _ref11[0],\n\t\t\t\tkp2Id = _ref11[1]\n\n\t\t\tvar kp1 = points[kp1Id]\n\t\t\tvar kp2 = points[kp2Id]\n\t\t\tvar midPoint = {\n\t\t\t\tx: (kp1.x + kp2.x) / 2,\n\t\t\t\ty: (kp1.y + kp2.y) / 2\n\t\t\t}\n\t\t\treturn React.createElement('g', {\n\t\t\t\tkey: ''.concat(kp1.x, ',').concat(kp1.y, '.').concat(kp2.x, ',').concat(kp2.y)\n\t\t\t}, React.createElement('line', {\n\t\t\t\tx1: kp1.x * iw,\n\t\t\t\ty1: kp1.y * ih,\n\t\t\t\tx2: midPoint.x * iw,\n\t\t\t\ty2: midPoint.y * ih,\n\t\t\t\tstrokeWidth: 2,\n\t\t\t\tstroke: landmarks[kp1Id].color\n\t\t\t}), React.createElement('line', {\n\t\t\t\tx1: kp2.x * iw,\n\t\t\t\ty1: kp2.y * ih,\n\t\t\t\tx2: midPoint.x * iw,\n\t\t\t\ty2: midPoint.y * ih,\n\t\t\t\tstrokeWidth: 2,\n\t\t\t\tstroke: landmarks[kp2Id].color\n\t\t\t}))\n\t\t}))\n\t},\n\t'expanding-line': memo(function (_ref12) {\n\t\tvar region = _ref12.region,\n\t\t\tiw = _ref12.iw,\n\t\t\tih = _ref12.ih\n\t\tvar _region$expandingWidt = region.expandingWidth,\n\t\t\texpandingWidth = _region$expandingWidt === void 0 ? 0.005 : _region$expandingWidt,\n\t\t\tpoints = region.points\n\t\texpandingWidth = points.slice(-1)[0].width || expandingWidth\n\t\tvar pointPairs = points.map(function (_ref13, i) {\n\t\t\tvar x = _ref13.x,\n\t\t\t\ty = _ref13.y,\n\t\t\t\tangle = _ref13.angle,\n\t\t\t\twidth = _ref13.width\n\n\t\t\tif (!angle) {\n\t\t\t\tvar n = points[clamp(i + 1, 0, points.length - 1)]\n\t\t\t\tvar p = points[clamp(i - 1, 0, points.length - 1)]\n\t\t\t\tangle = Math.atan2(p.x - n.x, p.y - n.y) + Math.PI / 2\n\t\t\t}\n\n\t\t\tvar dx = Math.sin(angle) * (width || expandingWidth) / 2\n\t\t\tvar dy = Math.cos(angle) * (width || expandingWidth) / 2\n\t\t\treturn [{\n\t\t\t\tx: x + dx,\n\t\t\t\ty: y + dy\n\t\t\t}, {\n\t\t\t\tx: x - dx,\n\t\t\t\ty: y - dy\n\t\t\t}]\n\t\t})\n\t\tvar firstSection = pointPairs.map(function (_ref14) {\n\t\t\tvar _ref15 = _slicedToArray(_ref14, 2),\n\t\t\t\tp1 = _ref15[0],\n\t\t\t\tp2 = _ref15[1]\n\n\t\t\treturn p1\n\t\t})\n\t\tvar secondSection = pointPairs.map(function (_ref16) {\n\t\t\tvar _ref17 = _slicedToArray(_ref16, 2),\n\t\t\t\tp1 = _ref17[0],\n\t\t\t\tp2 = _ref17[1]\n\n\t\t\treturn p2\n\t\t}).asMutable()\n\t\tsecondSection.reverse()\n\t\tvar lastPoint = points.slice(-1)[0]\n\t\treturn React.createElement(React.Fragment, null, React.createElement('polygon', {\n\t\t\tpoints: firstSection.concat(region.candidatePoint ? [region.candidatePoint] : []).concat(secondSection).map(function (p) {\n\t\t\t\treturn ''.concat(p.x * iw, ' ').concat(p.y * ih)\n\t\t\t}).join(' '),\n\t\t\tstrokeWidth: 2,\n\t\t\tstroke: colorAlpha(region.color, 0.75),\n\t\t\tfill: colorAlpha(region.color, 0.1)\n\t\t}), points.map(function (_ref18, i) {\n\t\t\tvar x = _ref18.x,\n\t\t\t\ty = _ref18.y,\n\t\t\t\tangle = _ref18.angle\n\t\t\treturn React.createElement('g', {\n\t\t\t\tkey: i,\n\t\t\t\ttransform: 'translate('.concat(x * iw, ' ').concat(y * ih, ') rotate(').concat(-(angle || 0) * 180 / Math.PI, ')')\n\t\t\t}, React.createElement('g', null, React.createElement('rect', {\n\t\t\t\tx: -5,\n\t\t\t\ty: -5,\n\t\t\t\twidth: 10,\n\t\t\t\theight: 10,\n\t\t\t\tstrokeWidth: 2,\n\t\t\t\tstroke: colorAlpha(region.color, 0.75),\n\t\t\t\tfill: colorAlpha(region.color, 0.1)\n\t\t\t})))\n\t\t}), React.createElement('rect', {\n\t\t\tx: lastPoint.x * iw - 8,\n\t\t\ty: lastPoint.y * ih - 8,\n\t\t\twidth: 16,\n\t\t\theight: 16,\n\t\t\tstrokeWidth: 4,\n\t\t\tstroke: colorAlpha(region.color, 0.5),\n\t\t\tfill: 'transparent'\n\t\t}))\n\t}),\n\tpixel: function pixel() {\n\t\treturn null\n\t}\n}\nexport var WrappedRegionList = memo(function (_ref19) {\n\tvar regions = _ref19.regions,\n\t\tkeypointDefinitions = _ref19.keypointDefinitions,\n\t\tiw = _ref19.iw,\n\t\tih = _ref19.ih,\n\t\tfullSegmentationMode = _ref19.fullSegmentationMode\n\treturn regions.filter(function (r) {\n\t\treturn r.visible !== false\n\t}).map(function (r, i) {\n\t\tvar Component = RegionComponents[r.type]\n\t\treturn React.createElement(Component, {\n\t\t\tkey: `${i}-${r.regionId}`,\n\t\t\tregion: r,\n\t\t\tiw: iw,\n\t\t\tih: ih,\n\t\t\tkeypointDefinitions: keypointDefinitions,\n\t\t\tfullSegmentationMode: fullSegmentationMode\n\t\t})\n\t})\n}, function (n, p) {\n\treturn n.regions === p.regions && n.iw === p.iw && n.ih === p.ih\n})\nexport var RegionShapes = function RegionShapes(_ref20) {\n\tvar mat = _ref20.mat,\n\t\timagePosition = _ref20.imagePosition,\n\t\t_ref20$regions = _ref20.regions,\n\t\tregions = _ref20$regions === void 0 ? [] : _ref20$regions,\n\t\tkeypointDefinitions = _ref20.keypointDefinitions,\n\t\tfullSegmentationMode = _ref20.fullSegmentationMode\n\tvar iw = imagePosition.bottomRight.x - imagePosition.topLeft.x\n\tvar ih = imagePosition.bottomRight.y - imagePosition.topLeft.y\n\tif (isNaN(iw) || isNaN(ih)) return null\n\treturn React.createElement('svg', {\n\t\twidth: iw,\n\t\theight: ih,\n\t\tstyle: {\n\t\t\tposition: 'absolute',\n\t\t\tzIndex: 2,\n\t\t\tleft: imagePosition.topLeft.x,\n\t\t\ttop: imagePosition.topLeft.y,\n\t\t\tpointerEvents: 'none',\n\t\t\twidth: iw,\n\t\t\theight: ih\n\t\t}\n\t}, React.createElement(WrappedRegionList, {\n\t\tkey: 'wrapped-region-list',\n\t\tregions: regions,\n\t\tiw: iw,\n\t\tih: ih,\n\t\tkeypointDefinitions: keypointDefinitions,\n\t\tfullSegmentationMode: fullSegmentationMode\n\t}))\n}\nexport default RegionShapes"],"mappings":"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"}