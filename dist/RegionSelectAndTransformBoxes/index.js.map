{"version":3,"file":"index.js","names":["_slicedToArray","React","Fragment","memo","HighlightBox","styled","PreventScrollToParents","Tooltip","boxCursorMap","arePropsEqual","prev","next","region","dragWithPrimary","createWithPrimary","zoomWithPrimary","mat","RegionSelectAndTransformBox","_ref","r","mouseEvents","projectRegionBox","onBeginMovePoint","onSelectRegion","layoutParams","_ref$fullImageSegment","fullImageSegmentationMode","onBeginBoxTransform","onBeginMovePolygonPoint","onBeginMoveKeypoint","onAddPolygonPoint","showHighlightBox","isEditable","pbox","_layoutParams$current","current","iw","ih","createElement","type","locked","highlighted","a","map","_ref2","i","_ref3","px","py","Object","assign","key","onMouseDown","e","button","style","width","height","zIndex","border","position","left","x","w","top","y","h","cursor","borderRadius","points","_ref4","_ref5","proj","clone","inverse","applyToPoint","open","undefined","pointerEvents","length","p1","_ref6","_ref7","p2","pa","opacity","entries","_ref8","_ref9","keypointId","_ref9$","title","RegionSelectAndTransformBoxes","props","regions","filter","visible","id","n","p"],"sources":["../../src/RegionSelectAndTransformBoxes/index.js"],"sourcesContent":["import _slicedToArray from '@babel/runtime/helpers/esm/slicedToArray'\nimport React, { Fragment, memo } from 'react'\nimport HighlightBox from '../HighlightBox'\nimport { styled } from '@material-ui/core/styles'\nimport PreventScrollToParents from '../PreventScrollToParents'\nimport { Tooltip } from '@material-ui/core'\nvar boxCursorMap = [['nw-resize', 'n-resize', 'ne-resize'], ['w-resize', 'grab', 'e-resize'], ['sw-resize', 's-resize', 'se-resize']]\n\nvar arePropsEqual = function arePropsEqual(prev, next) {\n\treturn prev.region === next.region && prev.dragWithPrimary === next.dragWithPrimary && prev.createWithPrimary === next.createWithPrimary && prev.zoomWithPrimary === next.zoomWithPrimary && prev.mat === next.mat\n}\n\nexport var RegionSelectAndTransformBox = memo(function (_ref) {\n\tvar r = _ref.region,\n\t\tmouseEvents = _ref.mouseEvents,\n\t\tprojectRegionBox = _ref.projectRegionBox,\n\t\tdragWithPrimary = _ref.dragWithPrimary,\n\t\tcreateWithPrimary = _ref.createWithPrimary,\n\t\tzoomWithPrimary = _ref.zoomWithPrimary,\n\t\tonBeginMovePoint = _ref.onBeginMovePoint,\n\t\tonSelectRegion = _ref.onSelectRegion,\n\t\tlayoutParams = _ref.layoutParams,\n\t\t_ref$fullImageSegment = _ref.fullImageSegmentationMode,\n\t\tfullImageSegmentationMode = _ref$fullImageSegment === void 0 ? false : _ref$fullImageSegment,\n\t\tmat = _ref.mat,\n\t\tonBeginBoxTransform = _ref.onBeginBoxTransform,\n\t\tonBeginMovePolygonPoint = _ref.onBeginMovePolygonPoint,\n\t\tonBeginMoveKeypoint = _ref.onBeginMoveKeypoint,\n\t\tonAddPolygonPoint = _ref.onAddPolygonPoint,\n\t\tshowHighlightBox = _ref.showHighlightBox,\n\t\tisEditable = _ref.isEditable\n\tvar pbox = projectRegionBox(r)\n\tvar _layoutParams$current = layoutParams.current,\n\t\tiw = _layoutParams$current.iw,\n\t\tih = _layoutParams$current.ih\n\treturn React.createElement(Fragment, null, React.createElement(PreventScrollToParents, null, showHighlightBox && r.type !== 'polygon' && React.createElement(HighlightBox, {\n\t\tregion: r,\n\t\tmouseEvents: mouseEvents,\n\t\tdragWithPrimary: dragWithPrimary,\n\t\tcreateWithPrimary: createWithPrimary,\n\t\tzoomWithPrimary: zoomWithPrimary,\n\t\tonBeginMovePoint: onBeginMovePoint,\n\t\tonSelectRegion: onSelectRegion,\n\t\tpbox: pbox,\n\t\tisEditable: isEditable\n\t}), r.type === 'box' && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && mat.a < 1.2 && [[0, 0], [0.5, 0], [1, 0], [1, 0.5], [1, 1], [0.5, 1], [0, 1], [0, 0.5], [0.5, 0.5]].map(function (_ref2, i) {\n\t\tvar _ref3 = _slicedToArray(_ref2, 2),\n\t\t\tpx = _ref3[0],\n\t\t\tpy = _ref3[1]\n\t\t\n\t\treturn React.createElement('div', Object.assign({\n\t\t\tkey: `${i}-${px}-${py}`\n\t\t}, mouseEvents, {\n\t\t\tonMouseDown: function onMouseDown(e) {\n\t\t\t\tif (isEditable) {\n\t\t\t\t\tif (e.button === 0) return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n\t\t\t\t\tmouseEvents.onMouseDown(e)\n\t\t\t\t}\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\twidth: 8,\n\t\t\t\theight: 8,\n\t\t\t\tzIndex: 2,\n\t\t\t\tborder: '2px solid #535353',\n\t\t\t\tposition: 'absolute',\n\t\t\t\tleft: pbox.x - 4 - 2 + pbox.w * px,\n\t\t\t\ttop: pbox.y - 4 - 2 + pbox.h * py,\n\t\t\t\tcursor: boxCursorMap[py * 2][px * 2],\n\t\t\t\tborderRadius: px === 0.5 && py === 0.5 ? 4 : 0\n\t\t\t}\n\t\t}))\n\t}), r.type === 'polygon' && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && r.points.map(function (_ref4, i) {\n\t\tvar _ref5 = _slicedToArray(_ref4, 2),\n\t\t\tpx = _ref5[0],\n\t\t\tpy = _ref5[1]\n\n\t\tvar proj = mat.clone().inverse().applyToPoint(px * iw, py * ih)\n\t\treturn React.createElement('div', Object.assign({\n\t\t\tkey: `${i}-${px}-${py}`\n\t\t}, mouseEvents, {\n\t\t\tonMouseDown: function onMouseDown(e) {\n\t\t\t\tif (isEditable) {\n\t\t\t\t\tif (e.button === 0 && (!r.open || i === 0)) return onBeginMovePolygonPoint(r, i)\n\t\t\t\t\tmouseEvents.onMouseDown(e)\n\t\t\t\t}\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\twidth: 8,\n\t\t\t\theight: 8,\n\t\t\t\tborder: '2px solid #FFF',\n\t\t\t\tposition: 'absolute',\n\t\t\t\tcursor: !r.open ? 'move' : i === 0 ? 'pointer' : undefined,\n\t\t\t\tzIndex: 10,\n\t\t\t\tpointerEvents: r.open && i === r.points.length - 1 ? 'none' : undefined,\n\t\t\t\tleft: proj.x - 4,\n\t\t\t\ttop: proj.y - 4\n\t\t\t}\n\t\t}))\n\t}), r.type === 'polygon' && r.highlighted && !dragWithPrimary && !zoomWithPrimary && !r.locked && !r.open && r.points.length > 1 && r.points.map(function (p1, i) {\n\t\treturn [p1, r.points[(i + 1) % r.points.length]]\n\t}).map(function (_ref6) {\n\t\tvar _ref7 = _slicedToArray(_ref6, 2),\n\t\t\tp1 = _ref7[0],\n\t\t\tp2 = _ref7[1]\n\n\t\treturn [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2]\n\t}).map(function (pa, i) {\n\t\tvar proj = mat.clone().inverse().applyToPoint(pa[0] * iw, pa[1] * ih)\n\t\treturn React.createElement('div', Object.assign({\n\t\t\tkey: `${i}-${proj.x}-${proj.y}`\n\t\t}, mouseEvents, {\n\t\t\tonMouseDown: function onMouseDown(e) {\n\t\t\t\tif (isEditable) {\n\t\t\t\t\tif (e.button === 0) return onAddPolygonPoint(r, pa, i + 1)\n\t\t\t\t\tmouseEvents.onMouseDown(e)\n\t\t\t\t}\n\t\t},\n\t\t\tstyle: {\n\t\t\twidth: 8,\n\t\t\theight: 8,\n\t\t\tzIndex: 2,\n\t\t\tposition: 'absolute',\n\t\t\tcursor: 'copy',\n\t\t\tleft: proj.x - 4,\n\t\t\ttop: proj.y - 4,\n\t\t\tborder: '2px dotted #fff',\n\t\t\topacity: 0.5\n\t\t}\n\t\t}))\n\t}), r.type === 'keypoints' && !dragWithPrimary && !zoomWithPrimary && !r.locked && r.highlighted && Object.entries(r.points).map(function (_ref8, i) {\n\t\tvar _ref9 = _slicedToArray(_ref8, 2),\n\t\t\tkeypointId = _ref9[0],\n\t\t\t_ref9$ = _ref9[1],\n\t\t\tpx = _ref9$.x,\n\t\t\tpy = _ref9$.y\n\n\t\tvar proj = mat.clone().inverse().applyToPoint(px * iw, py * ih)\n\t\treturn React.createElement(Tooltip, {\n\t\t\ttitle: keypointId,\n\t\t\tkey: `${i}-${px}-${py}`\n\t\t}, React.createElement('div', Object.assign({\n\t\tkey: i\n\t}, mouseEvents, {\n\t\tonMouseDown: function onMouseDown(e) {\n\t\t\tif (isEditable) {\n\t\t\t\tif (e.button === 0 && (!r.open || i === 0)) return onBeginMoveKeypoint(r, keypointId)\n\t\t\t\tmouseEvents.onMouseDown(e)\n\t\t\t}\n\t\t},\n\t\tstyle: {\n\t\t\twidth: 8,\n\t\t\theight: 8,\n\t\t\tborder: '2px solid #FFF',\n\t\t\tposition: 'absolute',\n\t\t\tcursor: !r.open ? 'move' : i === 0 ? 'pointer' : undefined,\n\t\t\tzIndex: 10,\n\t\t\tpointerEvents: r.open && i === r.points.length - 1 ? 'none' : undefined,\n\t\t\tleft: proj.x - 4,\n\t\t\ttop: proj.y - 4\n\t\t}\n\t})))\n\t})))\n}, arePropsEqual)\nexport var RegionSelectAndTransformBoxes = memo(function (props) {\n\treturn props.regions.filter(function (r) {\n\t\treturn r.visible || r.visible === undefined\n\t}).filter(function (r) {\n\t\treturn !r.locked\n\t}).map(function (r, i) {\n\t\treturn React.createElement(RegionSelectAndTransformBox, Object.assign({\n\t\t\tkey: `${i}-${r.id}`,\n\t\t}, props, {\n\t\t\tregion: r\n\t\t}))\n\t})\n}, function (n, p) {\n\treturn n.regions === p.regions && n.mat === p.mat\n})\nexport default RegionSelectAndTransformBoxes"],"mappings":"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"}